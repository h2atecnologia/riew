!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).rine=e()}}(function(){return function o(i,f,a){function l(t,e){if(!f[t]){if(!i[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(c)return c(t,!0);var r=new Error("Cannot find module '"+t+"'");throw r.code="MODULE_NOT_FOUND",r}var u=f[t]={exports:{}};i[t][0].call(u.exports,function(e){return l(i[t][1][e]||e)},u,u.exports,o,i,f,a)}return f[t].exports}for(var c="function"==typeof require&&require,e=0;e<a.length;e++)l(a[e]);return l}({1:[function(u,e,o){(function(e){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(e){var o=!1,i=void 0,f=void 0,a=function(){};function l(){return o}var t={__rine:"routine",id:r(),isActive:l,name:(0,d.getFuncName)(e),in:function(t,n){var r=this;o=!0,f=function(e){o&&t(c.default.createElement(i,e))};var u=e(function(e){return i="function"==typeof e?e:function(){return e},f(n),new Promise(function(e){a=function(){return e()}})},{isMounted:l});(0,d.isGenerator)(u)&&!function t(e){if(s.default.isTask(e.value)){var n=e.value;if(n.controller=r,n.done)return void n.done.then(function(e){return t(u.next(e))})}e.done||t(u.next(e.value))}(u.next())},updated:function(e){f(e)},rendered:function(){a()},out:function(){o=!1}};return s.default.addController(t),t};var c=t("undefined"!=typeof window?window.React:void 0!==e?e.React:null),d=u("../utils"),s=t(u("./System"));function t(e){return e&&e.__esModule?e:{default:e}}var n=0,r=function(){return"r"+ ++n}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../utils":7,"./System":3}],2:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e,n){var r=0,u=e,o=[],t={__rine:"state",id:f(),set:function(e){u=e,o.forEach(function(e){return(0,e.update)(u)})},get:function(){return u},connect:function(e){var t=++r;return o.push({id:t,update:e}),function(){o=o.filter(function(e){return e.id!==t})}},destroy:function(){i.default.removeController(this)},put:function(e,t){n&&this.set(n(u,{type:e,payload:t}))}};return i.default.addController(t),t};var r,u=e("./System"),i=(r=u)&&r.__esModule?r:{default:r};var o=0,f=function(){return"s"+ ++o}},{"./System":3}],3:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=0,r={tasks:[],controllers:[],addController:function(e){this.controllers.push(e)},removeController:function(n){this.controllers=this.controllers.filter(function(e){return e.id!==n.id}),this.tasks=this.tasks.filter(function(e){var t=e.controller;return!t||t.id!==n.id})},addTask:function(e,t,n,r){var u={__rine:"task",id:"t"+ ++o,type:e,callback:t,controller:n,once:!(3<arguments.length&&void 0!==r)||r};return t||(u.done=new Promise(function(e){u.callback=e})),this.tasks.push(u),u},put:function(u,t){var o=[];this.tasks=this.tasks.filter(function(e){var t=e.type,n=e.callback,r=e.once;return t!==u||(o.push(n),!r)}),o.forEach(function(e){return e(t)}),this.controllers.forEach(function(e){"put"in e&&e.put(u,t)})},take:function(e,t,n){return this.addTask(e,t,n,!0)},takeEvery:function(e,t,n){return this.addTask(e,t,n,!1)},reset:function(){this.controllers=[],this.tasks=[]},isTask:function(e){return e&&"task"===e.__rine}};n.default=r},{}],4:[function(r,e,u){(function(e){"use strict";Object.defineProperty(u,"__esModule",{value:!0});var f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,u=!1,o=void 0;try{for(var i,f=e[Symbol.iterator]();!(r=(i=f.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){u=!0,o=e}finally{try{!r&&f.return&&f.return()}finally{if(u)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")};u.default=function(o,i){function e(e){var t=(0,l.useState)(function(r){return Object.keys(r).reduce(function(e,t){var n=r[t];return d(n)?e[t]=n.get():e[t]="function"==typeof n?n():n,e},{})}(i)),n=a(t,2),r=n[0],u=n[1];return(0,l.useEffect)(function(){var n=[];return Object.keys(i).forEach(function(t){var e=i[t];d(e)&&n.push(e.connect(function(e){return u(r=f({},r,function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n;return e}({},t,e)))}))}),function(){n.forEach(function(e){return e()})}},[]),c.default.createElement(o,f({},r,e))}return e.displayName="State("+(0,n.getFuncName)(o)+")",e};var t,l="undefined"!=typeof window?window.React:void 0!==e?e.React:null,c=(t=l)&&t.__esModule?t:{default:t},n=r("../utils");function d(e){return"state"===e.__rine}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../utils":7}],5:[function(r,e,u){(function(e){"use strict";Object.defineProperty(u,"__esModule",{value:!0});var c=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,u=!1,o=void 0;try{for(var i,f=e[Symbol.iterator]();!(r=(i=f.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){u=!0,o=e}finally{try{!r&&f.return&&f.return()}finally{if(u)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")};u.default=function(l){function e(e){var t=(0,d.useState)(null),n=c(t,2),r=n[0],u=n[1],o=(0,d.useState)(null),i=c(o,2),f=i[0],a=i[1];return(0,d.useEffect)(function(){f&&f.updated(e)},[e]),(0,d.useEffect)(function(){f&&f.rendered()},[r]),(0,d.useEffect)(function(){return a(f=(0,s.default)(l)),f.in(u,e),function(){f.out(),p.default.removeController(f)}},[]),r}return e.displayName="Routine("+(0,t.getFuncName)(l)+")",e};var d="undefined"!=typeof window?window.React:void 0!==e?e.React:null,s=n(r("./RoutineController")),p=n(r("./System")),t=r("../utils");function n(e){return e&&e.__esModule?e:{default:e}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../utils":7,"./RoutineController":1,"./System":3}],6:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.takeEvery=n.take=n.put=n.connect=n.state=n.routine=n.System=void 0;var r=e("./api/System");Object.defineProperty(n,"System",{enumerable:!0,get:function(){return a(r).default}});var u=e("./api/routine");Object.defineProperty(n,"routine",{enumerable:!0,get:function(){return a(u).default}});var o=e("./api/StateController");Object.defineProperty(n,"state",{enumerable:!0,get:function(){return a(o).default}});var i=e("./api/connect");Object.defineProperty(n,"connect",{enumerable:!0,get:function(){return a(i).default}});var f=a(r);function a(e){return e&&e.__esModule?e:{default:e}}n.put=f.default.put.bind(f.default),n.take=f.default.take.bind(f.default),n.takeEvery=f.default.takeEvery.bind(f.default)},{"./api/StateController":2,"./api/System":3,"./api/connect":4,"./api/routine":5}],7:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});n.isGenerator=function(e){return e&&"function"==typeof e.next},n.isPromise=function(e){return e&&"function"==typeof e.then},n.getFuncName=function(e){if(e.name)return e.name;var t=/^function\s+([\w\$]+)\s*\(/.exec(e.toString());return t?t[1]:"unknown"}},{}]},{},[6])(6)});