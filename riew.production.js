!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).Riew=e()}}(function(){return function e(t,r,n){function u(i,f){if(!r[i]){if(!t[i]){var a="function"==typeof require&&require;if(!f&&a)return a(i,!0);if(o)return o(i,!0);var c=new Error("Cannot find module '"+i+"'");throw c.code="MODULE_NOT_FOUND",c}var l=r[i]={exports:{}};t[i][0].call(l.exports,function(e){return u(t[i][1][e]||e)},l,l.exports,e,t,r,n)}return r[i].exports}for(var o="function"==typeof require&&require,i=0;i<n.length;i++)u(n[i]);return u}({1:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});r.STATE_DESTROY="STATE_DESTROY",r.EFFECT_EXPORTED="EFFECT_EXPORTED",r.QUEUE_END="QUEUE_END",r.QUEUE_STEP_IN="QUEUE_STEP_IN",r.QUEUE_STEP_OUT="QUEUE_STEP_OUT",r.HARVESTER_PRODUCE="HARVESTER_PRODUCE",r.RIEW_RENDER="RIEW_RENDER",r.RIEW_UNMOUNT="RIEW_UNMOUNT"},{}],2:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t){for(var r=arguments.length,n=Array(r>1?r-1:0),u=1;u<r;u++)n[u-1]=arguments[u];if(e[t])return e[t].apply(e,n)}};var n,u=e("./grid");(n=u)&&n.__esModule},{"./grid":3}],3:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n,u,o,i=(u=[],o=[],(n={}).add=function(e){if(!e||!e.id)throw new Error('Each node in the grid must be an object with "id" field. Instead "'+e+'" given.');u.push(e)},n.remove=function(e){u=u.filter(function(t){return t.id!==e.id})},n.reset=function(){u=[],o=[]},n.nodes=function(){return u},n.on=function(e){return o.push(e)},n.dispatch=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return o.forEach(function(e){return e.apply(void 0,t)})},n);r.default=i},{}],4:[function(e,t,r){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(r,"__esModule",{value:!0});var u,o="function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?function(e){return void 0===e?"undefined":n(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":n(e)},i=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,u=!1,o=void 0;try{for(var i,f=e[Symbol.iterator]();!(n=(i=f.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){u=!0,o=e}finally{try{!n&&f.return&&f.return()}finally{if(u)throw o}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},f=p(e("fast-deep-equal")),a=e("./state"),c=p(e("./riew")),l=p(e("./react")),s=p(e("./grid")),d=p(e("./eventBus")),y=e("./constants");function p(e){return e&&e.__esModule?e:{default:e}}function v(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var h=(0,d.default)((v(u={},y.STATE_DESTROY,function(e){e.effects().forEach(function(e){"__exportedAs"in e&&E.undefineProduct(e.__exportedAs)}),s.default.remove(e)}),v(u,y.EFFECT_EXPORTED,function(e,t){e.__exportedAs=t,E.defineProduct(t,function(){return e})}),v(u,y.RIEW_UNMOUNT,function(e){s.default.remove(e)}),u));var m,g,b=function(e){e.defineProduct("state",function(e,t){var r=(0,a.State)(e,h,t),n=r.createEffect([]);return s.default.add(r),n}),e.defineProduct("mergeStates",function(t){var r=e.produce("state"),n=i(r,3),u=n[0],a=n[2];return a.get=function(){return Object.keys(t).reduce(function(e,r){var n=i(t[r],1)[0];return e[r]=n(),e},{})},a.set=function(e){if("object"!==(void 0===e?"undefined":o(e)))throw new Error("Wrong merged state value. Must be key-value pairs.");Object.keys(e).forEach(function(r){if(!t[r])throw new Error('There is no state with key "'+r+'".');var n=i(t[r],2),u=n[0],o=n[1];(0,f.default)(e[r],u())||o(e[r])},{})},Object.keys(t).forEach(function(e){t[e].pipe(a.triggerListeners).subscribe()}),u}),e.defineProduct("riew",function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var u=c.default.apply(void 0,[h,e].concat(r));return s.default.add(u),u}),e.defineProduct("reactRiew",function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return l.default.apply(void 0,[e].concat(r))})},E=(g={},(m={}).defineProduct=function(e,t){if(g[e])throw new Error('A product with type "'+e+'" already exists.');g[e]=t},m.undefineProduct=function(e){if(!g[e])throw new Error('There is no product with type "'+e+'" to be removed.');delete g[e]},m.produce=function(e){for(var t,r=arguments.length,n=Array(r>1?r-1:0),u=1;u<r;u++)n[u-1]=arguments[u];if(!g[e])throw new Error('There is no product with type "'+e+'".');var o=(t=g)[e].apply(t,n);return h(y.HARVESTER_PRODUCE,o),o},m.reset=function(){g={},b(m)},m);b(E),r.default=E},{"./constants":1,"./eventBus":2,"./grid":3,"./react":13,"./riew":14,"./state":15,"fast-deep-equal":17}],5:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.grid=r.harvester=r.parallel=r.serial=r.compose=r.reset=r.register=r.use=r.react=r.riew=r.merge=r.state=void 0;var n=e("./utils");Object.defineProperty(r,"compose",{enumerable:!0,get:function(){return n.compose}}),Object.defineProperty(r,"serial",{enumerable:!0,get:function(){return n.serial}}),Object.defineProperty(r,"parallel",{enumerable:!0,get:function(){return n.parallel}});var u=i(e("./harvester")),o=i(e("./grid"));function i(e){return e&&e.__esModule?e:{default:e}}r.state=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return u.default.produce("state",e,t)},r.merge=function(e){return u.default.produce("mergeStates",e)},r.riew=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return u.default.produce.apply(u.default,["riew"].concat(t))},r.react={riew:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return u.default.produce.apply(u.default,["reactRiew"].concat(t))}},r.use=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return u.default.produce.apply(u.default,[e].concat(r))},r.register=function(e,t){return u.default.defineProduct(e,function(){return t})},r.reset=function(){u.default.reset(),o.default.reset()},r.harvester=u.default,r.grid=o.default},{"./grid":3,"./harvester":4,"./utils":16}],6:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.implementLoggableInterface=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e.loggable=t,e.loggability=function(t){return e.loggable=t,e}}},{}],7:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};r.createQueueAPI=function(){return n({},s)},r.createQueue=function(e,t,r){var n=e.set,o=e.get,i=e.queueAPI,f={id:(0,u.getId)("q"),index:null,causedBy:t.id,setStateValue:n,getStateValue:o,result:o(),items:[],add:function(e,t){this.items.push({type:e,func:t})},process:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];function u(){return f.index<f.items.length?o():(f.index=null,r.end(f),f.result)}function o(){r.stepIn(f);var e=f.items[f.index],n=e.type,o=e.func,a=i[n];if(a)return a(f,o,t,function(e){return f.result=e,r.stepOut(f),f.index++,u()});throw new Error('Unsupported method "'+n+'".')}return f.index=0,r.start(f),f.items.length>0?o():(r.end(f),f.result)},cancel:function(){f.items=[]}};return t.items.forEach(function(e){var t=e.type,r=e.func;return f.add(t,r)}),f};var u=e("./utils"),o=l(e("./queueMethods/pipe")),i=l(e("./queueMethods/map")),f=l(e("./queueMethods/mapToKey")),a=l(e("./queueMethods/mutate")),c=l(e("./queueMethods/filter"));function l(e){return e&&e.__esModule?e:{default:e}}var s={define:function(e,t){this[e]=function(e,r,n,o){var i=t.apply(void 0,function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}(r))(e.result,n,e);return(0,u.isPromise)(i)?i.then(o):o(i)}}};s.define("pipe",o.default),s.define("map",i.default),s.define("mapToKey",f.default),s.define("mutate",a.default),s.define("filter",c.default)},{"./queueMethods/filter":8,"./queueMethods/map":9,"./queueMethods/mapToKey":10,"./queueMethods/mutate":11,"./queueMethods/pipe":12,"./utils":16}],8:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e){return function(t,r,u){var o=e.apply(void 0,[t].concat(function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}(r)));return(0,n.isPromise)(o)?o.then(function(e){return e||(u.index=u.items.length),t}):(o||(u.index=u.items.length),t)}};var n=e("../utils")},{"../utils":16}],9:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e){return function(t,r){return(e||function(e){return e}).apply(void 0,[t].concat(function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}(r)))}}},{}],10:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e){return function(t,r){return function(t){return function(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r;return e}({},e,t)}.apply(void 0,[t].concat(function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}(r)))}}},{}],11:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e){return function(t,r,u){var o=(e||function(e,t){return t}).apply(void 0,[t].concat(function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}(r)));return(0,n.isPromise)(o)?o.then(function(e){return u.setStateValue(e),e}):(u.setStateValue(o),o)}};var n=e("../utils")},{"../utils":16}],12:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e){return function(t,r){var u=(e||function(){}).apply(void 0,[t].concat(function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}(r)));return(0,n.isPromise)(u)?u.then(function(){return t}):t}};var n=e("../utils")},{"../utils":16}],13:[function(e,t,r){(function(t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,u=!1,o=void 0;try{for(var i,f=e[Symbol.iterator]();!(n=(i=f.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){u=!0,o=e}finally{try{!n&&f.return&&f.return()}finally{if(u)throw o}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")};r.default=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),u=1;u<t;u++)r[u-1]=arguments[u];return function t(){var u=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],l=function(t){var f=(0,o.useState)(null),l=n(f,2),s=l[0],d=l[1],y=(0,o.useState)(null),p=n(y,2),v=p[0],h=p[1];return(0,o.useEffect)(function(){s&&s.update(t)},[t]),(0,o.useEffect)(function(){var n;(s=a.riew.apply(void 0,[function(t){h(null===t?null:i.default.createElement(e,t))}].concat(r)),u&&u.length>0)&&(s=(n=s).with.apply(n,c(u)));return d(s),s.mount(t),function(){s.unmount()}},[]),v};return l.displayName="Riew("+(0,f.getFuncName)(e)+")",l.with=function(){for(var e=arguments.length,r=Array(e),n=0;n<e;n++)r[n]=arguments[n];return t(r)},l}()};var u,o="undefined"!=typeof window?window.React:void 0!==t?t.React:null,i=(u=o)&&u.__esModule?u:{default:u},f=e("../utils"),a=e("../index");function c(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../index":5,"../utils":16}],14:[function(e,t,r){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(r,"__esModule",{value:!0});var u=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,u=!1,o=void 0;try{for(var i,f=e[Symbol.iterator]();!(n=(i=f.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){u=!0,o=e}finally{try{!n&&f.return&&f.return()}finally{if(u)throw o}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i="function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?function(e){return void 0===e?"undefined":n(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":n(e)};r.default=function e(t,r){for(var n=arguments.length,i=Array(n>2?n-2:0),v=2;v<n;v++)i[v-2]=arguments[v];var h={id:(0,c.getId)("r"),name:(0,c.getFuncName)(r)};var m=!1;var g=[];var b=[];var E=[];var _={};var A=(0,f.state)({},!1),w=u(A,1),P=w[0];var O=(0,f.state)({},!1),S=u(O,1),T=S[0];var j=(0,f.state)({},!1),M=u(j,1),R=M[0];var U=function(){return m};(0,s.implementLoggableInterface)(h);var x=T.mutate(function(e,t){var r=o({},e);return t&&Object.keys(t).forEach(function(e){if((0,a.isEffect)(t[e])&&!t[e].isMutating()){var n=u(t[e],3),o=n[0],i=n[2];o.loggability(!1),r[e]=o(),f=i.id,b.find(function(e){var t=e.stateId;return f===t})||b.push({stateId:i.id,effect:o.pipe(function(){return I(d({},e,o()))}).subscribe()})}else r[e]=t[e];var f}),r});var I=x.filter(U).pipe(function(e){r(e),t(l.RIEW_RENDER,h,e)});var q=R.mutate(p);var N=P.mutate(p);q({state:function(){var e=f.state.apply(void 0,arguments);return g.push(e),e},render:function(e){return y(e,"The `render` method"),I(e)},isActive:U,props:P});function D(){Object.keys(_).forEach(function(e){var t=void 0;"@"===e.charAt(0)?(e=e.substr(1,e.length),t=(0,f.use)(e)):t=_[e],x(d({},e,t)),q(d({},e,t))})}h.isActive=U;h.mount=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};y(e,"The `mount` method"),N(e),x(e),D();var t=c.parallel.apply(void 0,i)(R()),r=function(e){return E=e||[]};return(0,c.isPromise)(t)?t.then(r):r(t),m=!0,I(),h};h.update=function(e){I(e),N(e)};h.unmount=function(){return m=!1,T.destroy(),R.destroy(),g.forEach(function(e){return e.destroy()}),g=[],E.filter(function(e){return"function"==typeof e}).forEach(function(e){return e()}),E=[],b.forEach(function(e){return e.effect.unsubscribe()}),b=[],t(l.RIEW_UNMOUNT,h,T()),h};h.with=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return h.__setExternals(t),h};h.test=function(n){var u=e.apply(void 0,[t,r].concat(i));return u.__setExternals([n]),u};h.__setExternals=function(e){_=o({},_,e.reduce(function(e,t){return e=o({},e,"string"==typeof t?d({},"@"+t,!0):t)},{}))};h.__output=T;return h};var f=e("./index"),a=e("./state"),c=e("./utils"),l=e("./constants"),s=e("./interfaces");function d(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function y(e,t){if(null===e||void 0!==e&&"object"!==(void 0===e?"undefined":i(e)))throw new Error(t+' must be called with a key-value object. Instead "'+e+'" passed.');return e}var p=function(e,t){return o({},e,t)}},{"./constants":1,"./index":5,"./interfaces":6,"./state":15,"./utils":16}],15:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.isEffect=function(e){return e&&e.id&&"e"===e.id.split("_").shift()},r.State=function(e,t,r){var n={},u=e,s=[],d=[],y=[],p=!0;function v(e,t){var r=[].concat(l(e.items));t&&r.push(t);var u=n.createEffect(r);return u.loggability(e.loggable),u.setParent(e.id),u}function h(e){"undefined"!=typeof Symbol&&void 0!==Symbol.iterator&&(e[Symbol.iterator]=function(){var t=[e.map(),e.mutate(),n],r=0;return{next:function(){return{value:t[r++],done:r>t.length}}}})}function m(e){Object.keys(n.queueAPI).forEach(function(t){e[t]=function(){for(var r=arguments.length,n=Array(r),u=0;u<r;u++)n[u]=arguments[u];return v(e,{type:t,func:n})}})}return(0,c.implementLoggableInterface)(n,r),n.id=(0,i.getId)("s"),n.queues=function(){return d},n.effects=function(){return y},n.queueAPI=(0,f.createQueueAPI)(),n.triggerListeners=function(){return s.forEach(function(e){return e()})},n.get=function(){return u},n.set=function(e){(0,o.default)(u,e)||(u=e,n.triggerListeners())},n.cancel=function(){d.forEach(function(e){return e.cancel()}),d=[]},n.destroy=function(){p=!1,n.cancel(),s=[],t(a.STATE_DESTROY,n),y=[]},n.listeners=function(){return s},n.addListener=function(e){return s.push(e)},n.removeListener=function(e){return s=s.filter(function(t){return t.id!==e.id})},n.runQueue=function(e,r){if(!p)return u;var o=(0,f.createQueue)(n,e,{start:function(e){},stepIn:function(r){t(a.QUEUE_STEP_IN,e)},stepOut:function(r){t(a.QUEUE_STEP_OUT,e)},end:function(r){t(a.QUEUE_END,e),d=d.filter(function(e){return e.id!==r.id})}});return d.push(o),o.process.apply(o,l(r))},n.createEffect=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=function e(){for(var t=arguments.length,r=Array(t),u=0;u<t;u++)r[u]=arguments[u];return n.runQueue(e,r)};return r.id=(0,i.getId)("e"),r.items=e,r.parent=n.id,y.push(r),(0,c.implementLoggableInterface)(r,n.loggable),h(r),m(r),r.define=function(e,t){return n.queueAPI.define(e,t),y.forEach(m),r},r.isMutating=function(){return!!r.items.find(function(e){return"mutate"===e.type})},r.subscribe=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(r.isMutating())throw new Error("You should not subscribe a effect that mutates the state. This will lead to endless recursion.");return e&&r(),n.addListener(r),r},r.unsubscribe=function(){return n.removeListener(r),r},r.destroy=function(){return n.destroy(),r},r.cancel=function(){d=d.filter(function(e){return e.causedBy!==r.id||(e.cancel(),!1)})},r.export=function(e){return t(a.EFFECT_EXPORTED,r,e),r},r.test=function(e){var t=v(r),n={setValue:function(e){t.items=[{type:"map",func:[function(){return e}]}].concat(l(t.items))},swap:function(e,r,n){Array.isArray(r)||(r=[r]),t.items[e].func=r,n&&(t.items[e].type=n)},swapFirst:function(e,t){n.swap(0,e,t)},swapLast:function(e,r){n.swap(t.items.length-1,e,r)}};return e(n),t},r.setParent=function(e){return r.parent=e},r},n};var n,u=e("fast-deep-equal"),o=(n=u)&&n.__esModule?n:{default:n},i=e("./utils"),f=e("./queue"),a=e("./constants"),c=e("./interfaces");function l(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}},{"./constants":1,"./interfaces":6,"./queue":7,"./utils":16,"fast-deep-equal":17}],16:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=r.isPromise=function(e){return e&&"function"==typeof e.then},u=(r.isObjectLiteral=function(e){return!!e&&e.constructor==={}.constructor},r.getFuncName=function(e){if(e.name)return e.name;var t=/^function\s+([\w\$]+)\s*\(/.exec(e.toString());return t?t[1]:"unknown"},r.compose=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(e){var r=!1,u=function(){},o=[].concat(t);return function t(){if(0!==o.length){var i=o.shift()(e);n(i)?(r=!0,i.then(function(r){e=r,t()})):(e=i,t())}else u(e)}(),r?new Promise(function(e){return u=e}):e}},r.serial=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(e){var r=!1,u=function(){},o=[],i=[].concat(t);return function t(){if(0!==i.length){var f=i.shift()(e);n(f)?(r=!0,f.then(function(e){o.push(e),t()})):(o.push(f),t())}else u(o)}(),r?new Promise(function(e){return u=e}):o}},r.parallel=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(e){var r=!1,u=[],o=[].concat(t);return function t(){if(0!==o.length){var i=o.shift()(e);n(i)&&(r=!0),u.push(i),t()}}(),r?Promise.all(u.map(function(e){return n(e)?e:Promise.resolve(e)})):u}},0);r.getId=function(e){return e+"_"+ ++u}},{}],17:[function(e,t,r){"use strict";var n=Array.isArray,u=Object.keys,o=Object.prototype.hasOwnProperty;t.exports=function e(t,r){if(t===r)return!0;if(t&&r&&"object"==typeof t&&"object"==typeof r){var i,f,a,c=n(t),l=n(r);if(c&&l){if((f=t.length)!=r.length)return!1;for(i=f;0!=i--;)if(!e(t[i],r[i]))return!1;return!0}if(c!=l)return!1;var s=t instanceof Date,d=r instanceof Date;if(s!=d)return!1;if(s&&d)return t.getTime()==r.getTime();var y=t instanceof RegExp,p=r instanceof RegExp;if(y!=p)return!1;if(y&&p)return t.toString()==r.toString();var v=u(t);if((f=v.length)!==u(r).length)return!1;for(i=f;0!=i--;)if(!o.call(r,v[i]))return!1;for(i=f;0!=i--;)if(!e(t[a=v[i]],r[a]))return!1;return!0}return t!=t&&r!=r}},{}]},{},[5])(5)});