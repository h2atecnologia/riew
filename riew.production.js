!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).Riew=e()}}(function(){return function e(t,n,r){function u(i,a){if(!n[i]){if(!t[i]){var c="function"==typeof require&&require;if(!a&&c)return c(i,!0);if(o)return o(i,!0);var f=new Error("Cannot find module '"+i+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[i]={exports:{}};t[i][0].call(l.exports,function(e){return u(t[i][1][e]||e)},l,l.exports,e,t,n,r)}return n[i].exports}for(var o="function"==typeof require&&require,i=0;i<r.length;i++)u(r[i]);return u}({1:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(){var e=(0,o.default)();return e.setValue=function(t){return e.value=t},e.put=function(t,n){e.value=[t],n(!0)},e.take=function(t){t(e.value[0])},e};var r,u=e("./Interface"),o=(r=u)&&r.__esModule?r:{default:r}},{"./Interface":4}],2:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=(0,o.default)();return n.setValue=function(e){return n.value=e},n.put=function(r,u){var o=!0;n.value.length<e?n.value.push(r):t?(n.value.shift(),n.value.push(r)):o=!1,n.takes.length>0&&n.takes.shift()(n.value.shift()),u(o)},n.take=function(e){0===n.value.length?n.takes.push(e):e(n.value.shift())},n};var r,u=e("./Interface"),o=(r=u)&&r.__esModule?r:{default:r}},{"./Interface":4}],3:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=(0,o.default)();return t.setValue=function(e){return t.value=e},t.put=function(n,r){0===t.takes.length?t.value.length<e?(t.value.push(n),r(!0)):t.puts.push(function(e){t.value.push(n),t.takes.length>0&&t.takes.shift()(t.value.shift()),r(e||!0)}):(t.value.push(n),t.takes.shift()(t.value.shift()),r(!0))},t.take=function(n){if(0===t.value.length)t.puts.length>0?(t.puts.shift()(),t.take(n)):t.takes.push(n);else{var r=t.value.shift();t.value.length<e&&t.puts.length>0&&t.puts.shift()(),n(r)}},t};var r,u=e("./Interface"),o=(r=u)&&r.__esModule?r:{default:r}},{"./Interface":4}],4:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(){return{value:[],puts:[],takes:[],isEmpty:function(){return 0===this.value.length},reset:function(){this.value=[],this.puts=[],this.takes=[]},setValue:function(e){this.value=e},getValue:function(){return this.value}}}},{}],5:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=i(e("./FixedBuffer")),u=i(e("./DroppingBuffer")),o=i(e("./DivorcedBuffer"));function i(e){return e&&e.__esModule?e:{default:e}}var a={fixed:r.default,dropping:u.default,sliding:function(e){return(0,u.default)(e,!0)},divorced:o.default};n.default=a},{"./DivorcedBuffer":1,"./DroppingBuffer":2,"./FixedBuffer":3}],6:[function(e,t,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0});var u=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,u=!1,o=void 0;try{for(var i,a=e[Symbol.iterator]();!(r=(i=a.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){u=!0,o=e}finally{try{!r&&a.return&&a.return()}finally{if(u)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},o="function"==typeof Symbol&&"symbol"===r(Symbol.iterator)?function(e){return void 0===e?"undefined":r(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":r(e)};n.createChannel=function(){for(var e=c.OPEN,t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=function(e){var t=void 0,n=void 0;2===e.length?(t=e[0],n=e[1]):1===e.length&&"string"==typeof e[0]?(t=e[0],n=s.default.fixed()):1===e.length&&"object"===o(e[0])?(t=(0,a.getId)("ch"),n=e[0]):(t=(0,a.getId)("ch"),n=s.default.fixed());return[t,n]}(n),l=u(i,2),d=l[0],v=l[1];if(f.CHANNELS.exists(d))return f.CHANNELS.get(d);var p=f.CHANNELS.set(d,{id:d,"@channel":!0,subscribers:[]});return p.isActive=function(){return p.state()===c.OPEN},p.buff=v,p.state=function(t){return void 0!==t&&(e=t),e},p.value=function(){return v.getValue()},p};var i,a=e("../utils"),c=e("./constants"),f=e("../index"),l=e("./buffer"),s=(i=l)&&i.__esModule?i:{default:i}},{"../index":14,"../utils":17,"./buffer":5,"./constants":7}],7:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});n.OPEN=Symbol("OPEN"),n.CLOSED=Symbol("CLOSED"),n.ENDED=Symbol("ENDED"),n.PUT="PUT",n.TAKE="TAKE",n.NOOP="NOOP",n.SLEEP="SLEEP",n.STOP="STOP",n.READ="READ",n.CALL_ROUTINE="CALL_ROUTINE",n.FORK_ROUTINE="FORK_ROUTINE",n.NOTHING=Symbol("NOTHING"),n.ALL_REQUIRED=Symbol("ALL_REQUIRED"),n.ONE_OF=Symbol("ONE_OF"),n.CHANNELS={channels:{},getAll:function(){return this.channels},get:function(e){return this.channels[e]},set:function(e,t){return this.channels[e]=t,t},del:function(e){delete this.channels[e]},exists:function(e){return!!this.channels[e]},reset:function(){this.channels={}}}},{}],8:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./buffer");Object.defineProperty(n,"buffer",{enumerable:!0,get:function(){return(e=r,e&&e.__esModule?e:{default:e}).default;var e}});var u=e("./channel");Object.keys(u).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return u[e]}})});var o=e("./ops");Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return o[e]}})});var i=e("./state");Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return i[e]}})});var a=e("./constants");Object.keys(a).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return a[e]}})})},{"./buffer":5,"./channel":6,"./constants":7,"./ops":9,"./state":10}],9:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.isChannel=void 0;var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};n.put=function(e,t){return{channels:e,op:u.PUT,item:t}},n.sput=l,n.take=function(e,t){return{channels:e,op:u.TAKE,options:t}},n.stake=s,n.read=function(e,t){return{channels:e,op:u.READ,options:r({},t,{read:!0})}},n.sread=d,n.unread=function(e,t){(e=(0,a.normalizeChannels)(e)).forEach(function(e){h(t)&&(t=t.__subFunc),e.subscribers=e.subscribers.filter(function(e){return e.callback!==t})})},n.unreadAll=function(e){(0,a.normalizeChannels)(e).forEach(function(e){e.subscribers=[]})},n.close=v,n.sclose=function(e){return v(e)},n.channelReset=p,n.schannelReset=function(e){p(e)},n.call=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return{op:u.CALL_ROUTINE,routine:e,args:n}},n.fork=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return{op:u.FORK_ROUTINE,routine:e,args:n}},n.merge=function(){for(var e=(0,o.chan)(),t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];return n.forEach(function(t){!function n(){s(t,function(t){t!==u.CLOSED&&t!==u.ENDED&&e.state()===u.OPEN&&l(e,t,n)})}()}),e},n.timeout=function(e){var t=(0,o.chan)();return setTimeout(function(){return v(t)},e),t},n.go=y,n.sleep=function(e,t){if("function"!=typeof t)return{op:u.SLEEP,ms:e};setTimeout(t,e)},n.stop=function(){return{op:u.STOP}};var u=e("./constants"),o=e("../index"),i=e("../utils"),a=e("./utils");function c(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var f=function(){};function l(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:f,r=(e=(0,a.normalizeChannels)(e,"WRITE")).map(function(){return u.NOTHING}),o=e.length>1?t:[t];e.forEach(function(e,t){var i=e.state();i===u.CLOSED||i===u.ENDED?n(i):function(e,t,n){var r=e.subscribers.map(function(){return 1});if(0===r.length)return n();var u=[].concat(c(e.subscribers));e.subscribers=[],u.forEach(function(u){var o=u.notify;u.listen&&e.subscribers.push(u),o(t,function(){r.shift(),0===r.length&&n()})})}(e,o[t],function(){e.buff.put(o[t],function(e){r[t]=e,r.includes(u.NOTHING)||n(1===r.length?r[0]:r)})})})}function s(e,t,n){e=(0,a.normalizeChannels)(e),n=(0,a.normalizeOptions)(n);var r=e.map(function(){return u.NOTHING}),o=n,l=o.transform,s=o.onError,d=o.initialCall,v=o.listen,p=function(e,o){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:f;r[o]=e;var d=null;if(n.strategy===u.ONE_OF?d=[e,o]:r.includes(u.NOTHING)||(d=[].concat(c(r))),null!==d)if(l)try{(0,i.isGeneratorFunction)(l)?y.apply(void 0,[l,function(e){return t(e),a()}].concat(c(d))):(t(l.apply(void 0,c(d))),a())}catch(e){if(null===s)throw e;s(e)}else n.strategy===u.ONE_OF?t.apply(void 0,c(d)):t(1===d.length?d[0]:d),a()},h=e.map(function(e,r){var o=e.state(),i={};if(o===u.ENDED)p(u.ENDED,r);else if(o===u.CLOSED&&e.buff.isEmpty())e.state(u.ENDED),p(u.ENDED,r);else if(n.read){e.subscribers.find(function(e){return e.callback===t})||e.subscribers.push(i={callback:t,notify:function(e,t){return p(e,r,t)},listen:v});var a=e.value();d&&a.length>0&&p(a[0],r)}else e.buff.take(function(e){return p(e,r)});return i});return{listen:function(){h.forEach(function(e){return e.listen=!0})}}}function d(e,t,n){return s(e,(0,a.normalizeTo)(t),r({},n,{read:!0}))}function v(e){return(e=(0,a.normalizeChannels)(e)).forEach(function(e){var t=e.buff.isEmpty()?u.ENDED:u.CLOSED;e.state(t),e.buff.puts.forEach(function(e){return e(t)}),e.buff.takes.forEach(function(e){return e(t)}),o.grid.remove(e),e.subscribers=[],u.CHANNELS.del(e.id)}),{op:u.NOOP}}function p(e){return(e=(0,a.normalizeChannels)(e)).forEach(function(e){e.state(u.OPEN),e.buff.reset()}),{op:u.NOOP}}var h=n.isChannel=function(e){return e&&!0===e["@channel"]};function y(e){for(var t=arguments.length,n=Array(t>2?t-2:0),r=2;r<t;r++)n[r-2]=arguments[r];var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},a="STOPPED",f="RUNNING",v={children:[],stop:function(){f=a,this.children.forEach(function(e){return e.stop()})},rerun:function(){h=e.apply(void 0,n),g()}},p=function(e){return v.children.push(e)},h=e.apply(void 0,n);function b(e){switch(e.value.op){case u.PUT:l(e.value.channels,e.value.item,g);break;case u.TAKE:s(e.value.channels,function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];g(1===t.length?t[0]:t)},e.value.options);break;case u.NOOP:g();break;case u.SLEEP:setTimeout(g,e.value.ms);break;case u.STOP:f=a;break;case u.READ:d(e.value.channels,g,e.value.options);break;case u.CALL_ROUTINE:p(y.apply(void 0,[e.value.routine,g].concat(c(e.value.args),n)));break;case u.FORK_ROUTINE:p(y.apply(void 0,[e.value.routine,function(){}].concat(n,c(e.value.args)))),g();break;default:throw new Error("Unrecognized operation "+e.value.op+" for a routine.")}}function g(e){if(f!==a){var t=h.next(e);!0===t.done?(o&&o(t.value),t.value&&!0===t.value["@go"]&&v.rerun()):(0,i.isPromise)(t.value)?t.value.then(g).catch(function(e){return b(h.throw(e))}):b(t)}}return g(),v}y["@go"]=!0},{"../index":14,"../utils":17,"./constants":7,"./utils":11}],10:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.createState=function(){var e=arguments.length<=0?void 0:arguments[0],t=(0,u.getId)("state"),n=[],o=[],i=arguments.length>0;function a(e){return function(t){if(null===e)throw t;e(t)}}function c(t,n){var o=t.ch,i=t.selector,c=t.onError;try{if((0,u.isGeneratorFunction)(i))return void(0,r.go)(i,function(e){return(0,r.sput)(o,e)},e);(0,r.sput)(o,i(n))}catch(e){a(c)(e)}}var f={id:t,"@state":!0,READ:t+"_read",WRITE:t+"_write",select:function(t){var u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return e},o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=(0,r.isChannel)(t)?t:(0,r.chan)(t,r.buffer.divorced());a["@statereadchannel"]=!0;var f={ch:a,selector:u,onError:o};return n.push(f),i&&c(f,e),this},mutate:function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e,t){return t},f=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,l=(0,r.isChannel)(t)?t:(0,r.chan)(t,r.buffer.divorced());l["@statewritechannel"]=!0;var s={ch:l};return o.push(s),(0,r.sread)(l,function(t){e=t,n.forEach(function(t){return c(t,e)})},{transform:regeneratorRuntime.mark(function t(n){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!(0,u.isGeneratorFunction)(i)){t.next=5;break}return t.next=4,(0,r.call)(i,e,n);case 4:return t.abrupt("return",t.sent);case 5:return t.abrupt("return",i(e,n));case 8:t.prev=8,t.t0=t.catch(0),a(f)(t.t0);case 11:case"end":return t.stop()}},t,this,[[0,8]])}),onError:a(f),initialCall:!0,listen:!0}),this},destroy:function(){return n.forEach(function(e){var t=e.ch;return(0,r.sclose)(t)}),o.forEach(function(e){var t=e.ch;return(0,r.sclose)(t)}),e=void 0,r.grid.remove(f),this},get:function(){return e},set:function(t){return e=t,n.forEach(function(t){c(t,e)}),t}};return f.select(f.READ),f.mutate(f.WRITE),f},n.isState=function(e){return e&&!0===e["@state"]},n.isStateReadChannel=function(e){return e&&!0===e["@statereadchannel"]},n.isStateWriteChannel=function(e){return e&&!0===e["@statewritechannel"]};var r=e("../index"),u=e("../utils")},{"../index":14,"../utils":17}],11:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.normalizeChannels=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"READ";Array.isArray(e)||(e=[e]);return e.map(function(e){return(0,r.isState)(e)&&(e=e[t]),(0,r.isChannel)(e)?e:(0,r.chan)(e)})},n.normalizeTo=function(e){if("function"==typeof e)return e;if((0,r.isChannel)(e))return e.__subFunc||(e.__subFunc=function(t){return(0,r.sput)(e,t)});if("string"==typeof e){return(0,r.chan)(e,r.buffer.divorced()).__subFunc=function(t){return(0,r.sput)(e,t)}}throw new Error("'read' accepts string, channel or a function as a second argument. "+e+" given.")},n.normalizeOptions=function(e){var t=(e=e||o).transform||o.transform,n=e.onError||o.onError,r=e.strategy||u.ALL_REQUIRED,i="listen"in e&&e.listen,a="read"in e&&e.read,c="initialCall"in e?e.initialCall:o.initialCall;return{transform:t,onError:n,strategy:r,initialCall:c,listen:i,read:a}};var r=e("../index"),u=e("./constants");var o={transform:null,onError:null,initialCall:!0}},{"../index":14,"./constants":7}],12:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r,u,o=(u=[],(r={}).add=function(e){if(!e||!e.id)throw new Error('Each node in the grid must be an object with "id" field. Instead "'+e+'" given.');u.push(e)},r.remove=function(e){var t=u.findIndex(function(t){return t.id===e.id});t>=0&&u.splice(t,1)},r.reset=function(){u=[]},r.nodes=function(){return u},r.getNodeById=function(e){return u.find(function(t){return t.id===e})},r);n.default=o},{}],13:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=a(e("./riew")),u=a(e("./react")),o=a(e("./grid")),i=e("./csp");function a(e){return e&&e.__esModule?e:{default:e}}var c,f,l=function(e){e.defineProduct("riew",function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),u=1;u<t;u++)n[u-1]=arguments[u];var i=r.default.apply(void 0,[e].concat(n));return o.default.add(i),i}),e.defineProduct("reactRiew",function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return u.default.apply(void 0,[e].concat(n))}),e.defineProduct("channel",function(){var e=i.createChannel.apply(void 0,arguments);return o.default.add(e),e}),e.defineProduct("state",function(){var e=i.createState.apply(void 0,arguments);return o.default.add(e),e})},s=(f={},(c={}).defineProduct=function(e,t){if(f[e])throw new Error('A product with type "'+e+'" already exists.');f[e]=t},c.undefineProduct=function(e){if(!f[e])throw new Error('There is no product with type "'+e+'" to be removed.');delete f[e]},c.produce=function(e){for(var t,n=arguments.length,r=Array(n>1?n-1:0),u=1;u<n;u++)r[u-1]=arguments[u];if(!f[e])throw new Error('There is no product with type "'+e+'".');return(t=f)[e].apply(t,r)},c.reset=function(){f={},l(c)},c.debug=function(){return{productNames:Object.keys(f)}},c);l(s),n.default=s},{"./csp":8,"./grid":12,"./react":15,"./riew":16}],14:[function(e,t,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0}),n.grid=n.harvester=n.reset=n.register=n.use=n.state=n.chan=n.react=n.riew=void 0;var u="function"==typeof Symbol&&"symbol"===r(Symbol.iterator)?function(e){return void 0===e?"undefined":r(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":r(e)},o=e("./csp");Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return o[e]}})});var i=c(e("./harvester")),a=c(e("./grid"));function c(e){return e&&e.__esModule?e:{default:e}}n.riew=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return i.default.produce.apply(i.default,["riew"].concat(t))},n.react={riew:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return i.default.produce.apply(i.default,["reactRiew"].concat(t))}},n.chan=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return i.default.produce.apply(i.default,["channel"].concat(t))},n.state=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return i.default.produce.apply(i.default,["state"].concat(t))},n.use=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return i.default.produce.apply(i.default,[e].concat(n))},n.register=function(e,t){return"object"!==(void 0===t?"undefined":u(t))&&"function"!=typeof t||(t.__registered=e),i.default.defineProduct(e,function(){return t}),t},n.reset=function(){return a.default.reset(),i.default.reset(),o.CHANNELS.reset()},n.harvester=i.default,n.grid=a.default},{"./csp":8,"./grid":12,"./harvester":13}],15:[function(e,t,n){(function(t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,u=!1,o=void 0;try{for(var i,a=e[Symbol.iterator]();!(r=(i=a.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){u=!0,o=e}finally{try{!r&&a.return&&a.return()}finally{if(u)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")};n.default=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),u=1;u<t;u++)n[u-1]=arguments[u];return function t(){var u=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],l=function(t){var a=(0,o.useState)(null),l=r(a,2),s=l[0],d=l[1],v=(0,o.useState)(null),p=r(v,2),h=p[0],y=p[1],b=(0,o.useRef)(!0);return(0,o.useEffect)(function(){s&&s.update(t)},[t]),(0,o.useEffect)(function(){var e;(s=c.riew.apply(void 0,[function(e){b&&y(null===e?null:e)}].concat(n)),u&&u.length>0)&&(s=(e=s).with.apply(e,f(u)));return d(s),s.mount(t),b.current=!0,function(){b.current=!1,s.unmount()}},[]),null===h?null:i.default.createElement(e,h)};return l.displayName="Riew_"+(0,a.getFuncName)(e),l.with=function(){for(var e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];return t(n)},l}()};var u,o="undefined"!=typeof window?window.React:void 0!==t?t.React:null,i=(u=o)&&u.__esModule?u:{default:u},a=e("../utils"),c=e("../index");function f(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../index":14,"../utils":17}],16:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};n.default=function e(t){for(var n=arguments.length,c=Array(n>1?n-1:0),f=1;f<n;f++)c[f-1]=arguments[f];var l=(0,o.getFuncName)(t);var s={id:(0,o.getId)(l),name:l};var d=a(t);var v=[];var p=[];var h=[];var y={};var b={};var g=function(){var e=u.state.apply(void 0,arguments);return v.push(e),e};var E=function(e,t){e in b||(b[e]=!0,(0,u.sread)(e,t,{listen:!0}))};var m=s.id+"_view";var O=s.id+"_props";var _=function(e){return Object.keys(e).reduce(function(t,n){return u.CHANNELS.exists(e[n])||(0,u.isChannel)(e[n])?(E(e[n],function(e){(0,u.sput)(m,i({},n,e))}),(0,u.stake)(e[n],function(e){return(0,u.sput)(m,i({},n,e))})):(0,u.isState)(e[n])?(E(e[n].READ,function(e){return(0,u.sput)(m,i({},n,e))}),(0,u.stake)(e[n].READ,function(e){return(0,u.sput)(m,i({},n,e))})):t[n]=e[n],t},{})};s.mount=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,o.requireObject)(e),E(O,function(e){return(0,u.sput)(m,e)}),E(m,d.push),h=c.map(function(e){return(0,u.go)(e,function(e){"function"==typeof e&&p.push(e)},r({render:function(e){(0,o.requireObject)(e),(0,u.sput)(m,_(e))},state:g,props:O},y))}),(0,o.isObjectEmpty)(y)||(0,u.sput)(m,_(y)),(0,u.sput)(O,e)};s.unmount=function(){p.forEach(function(e){return e()}),p=[],v.forEach(function(e){return e.destroy()}),v=[],h.forEach(function(e){return e.stop()}),h=[],d.destroy(),(0,u.close)(O),(0,u.close)(m)};s.update=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,o.requireObject)(e),(0,u.sput)(O,e)};s.with=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return s.__setExternals(t),s};s.test=function(n){var r=e.apply(void 0,[t].concat(c));return r.__setExternals([n]),r};s.__setExternals=function(e){var t=e.reduce(function(e,t){return e=r({},e,"string"==typeof t?i({},t,(0,u.use)(t)):t)},{});y=r({},y,t)};return s};var u=e("./index"),o=e("./utils");function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var a=function(e){var t={},n=!1,r=!0;return{push:function(i){i!==u.chan.CLOSED&&i!==u.chan.ENDED&&(t=(0,o.accumulate)(t,i),n||(n=!0,Promise.resolve().then(function(){r&&e(t),n=!1})))},destroy:function(){r=!1}}}},{"./index":14,"./utils":17}],17:[function(e,t,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0});var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o="function"==typeof Symbol&&"symbol"===r(Symbol.iterator)?function(e){return void 0===e?"undefined":r(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":r(e)};n.isObjectEmpty=function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},n.requireObject=function(e){if(null==e||void 0!==e&&"object"!==(void 0===e?"undefined":o(e)))throw new Error('A key-value object expected. Instead "'+e+'" passed.')};n.getFuncName=function(e){if(e.name)return e.name;var t=/^function\s+([\w\$]+)\s*\(/.exec(e.toString());return t?t[1]:"unknown"};var i=0;n.getId=function(e){return e+"_"+ ++i};n.accumulate=function(e,t){return u({},e,t)},n.isPromise=function(e){return e&&"function"==typeof e.then},n.isObjectLiteral=function(e){return!!e&&e.constructor==={}.constructor};var a=n.isGenerator=function(e){return e&&"function"==typeof e.next&&"function"==typeof e.throw};n.isGeneratorFunction=function(e){var t=e.constructor;return!!t&&("GeneratorFunction"===t.name||"GeneratorFunction"===t.displayName||a(t.prototype))}},{}]},{},[14])(14)});